<!DOCTYPE html>
<html>

<body>
    <h1>Trabalho Redes II - Chave Diffie Hellman</h1>
    <h3>Alunos: João Pedro de Matos de Oliveira (GRR 2017 1599) e Matheus Buratti Zagonel (GRR 2017 1594)</h3>

    <h5>Relatório</h5>

    <p>O trabalho tem como objetivo demonstrar o funcionamento de uma conexão TCP/IP entre cliente e servidor. Os programas cliente e servidor trocam mensagens utilizando criptografia DES. A chave de criptografia é estabelecida através do método de Diffie-Hellman. Ambos cliente e servidor inicialmente trocam as chaves "p,g, A,B" publicamente e em seguida criam as respectivas chaves secretas. Em seguida, trocam 4 mensagens criptografadas que são traduzidas e imprimidas no console do usuário. A 4ª mensagem é forçadamente criptografada utilizando a chave errada e provocará discrepância nos resultados.</p>

    <h5>Implementação</h5>

    <ul>
        <li>Os programas foram implementados utilizando python com as bibliotecas socket, pycrypto e random.</li>
        <li>Para a execução é necessário realizar a instalação da biblioteca "pycrypto" utilizando o comando "pip install pycrypto"</li>
        <li>Após instaladas as dependencias, deve-se inicializar primeiro o servidor e em seguida o cliente. Caso isto seja feito na ordem incorreta, o cliente não consegue estabelecer uma conexão e interrompe sua execução.</li>
        <li>A criptografia utilizada na tradução das mensagens é a criptografia do tipo DES.</li>
        <li>Para a conexão utilizando Protocolo TCP/IP, foi utilizada a biblioteca "socket" de python.</li>
        <li>Sabemos que em uma implementação real de uma conversa Cliente/Servidor a troca das chaves Diffie-Hellman é feita apenas uma vez por conexão. Porém, para fins de teste(tanto bem sucedidos quanto erros) e geração de logs, fazemos uma nova troca de chaves antes de enviarmos uma nova mensagem.</li>
        <li>O usuário deve digitar cada mensagem a ser enviada no terminal onde roda-se o cliente.</li>
        <li>O programa solicita o input de 4 mensagens. Sendo que as três primeiras utilizam a chave secreta corretamente e na quarta e última, forçamos a geração de uma chave incorreta.</li>
    </ul>

    <h6>Cliente</h6>

    <ol>
        <li>Conecta-se ao servidor</li>
        <li>Cria as chaves púlicas p, g, a e A</li>
        <li>Troca as chaves com o servidor</li>
        <li>Gera a chave secreta a partir de g, a e B</li>
        <li>Recebe input de uma mensagem do usuário</li>
        <li>Criptografa a mensagem</li>
        <li>Troca a mensagem Criptografada com o servidor</li>
    </ol>

    <h6>Servidor</h6>
    <ol>
        <li>Cria um socket</li>
        <li>Atribui ao socket o endereço (HOST, PORT) utilizando TCP/IP</li>
        <li>Habilita o socket a receber conexões</li>
        <li>Recebe as chaves p, g e A</li>
        <li>Cria e envia a Chave B</li>
        <li>Gera a chave secreta a partir de g, b e A</li>
        <li>Troca a mensagens Criptografadas com o cliente</li>
    </ol>

    <p>Para o cliente enviar novas mensagens, este deve receber uma mensagem de resposta do servidor como aponta a imagem a seguir</p>
    <p><img src="https://files.realpython.com/media/sockets-tcp-flow.1da426797e37.jpg"></img></p>

    <p>A troca de chaves Diffie-Hellman seguiu o seguinte esquema:</p>
    <p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/Diffie-Hellman_Key_Exchange.jpg/500px-Diffie-Hellman_Key_Exchange.jpg"></img></p>





<h5>Arquivos</h5>
    <p><a href="/cliente.py.txt">Código Fonte - Cliente</a></p>
    <p><a href="/LogCliente.txt">Log Cliente</a></p>
    <p><a href="/servidor.py.txt">Código Fonte - Servidor</a></p>
    <p><a href="/LogServidor.txt">Log Servidor</a></p>

    <h5>Bibliografia</h5>
    <p><a href="https://pt.wikipedia.org/wiki/Troca_de_chaves_de_Diffie%E2%80%93Hellman">Wikipedia - Diffie-Hellman</a></p>
    <p><a href="https://realpython.com/python-sockets/">Socket Programming in Python</a></p>
    <p><a href="https://www.dlitz.net/software/pycrypto/api/current/">Pycrypto - Module DES</a></p>
</body>

</html>